!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.handlib=e():t.handlib=e()}(this,function(){return function(t){function e(s){if(o[s])return o[s].exports;var i=o[s]={exports:{},id:s,loaded:!1};return t[s].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var o={};return e.m=t,e.c=o,e.p="",e(0)}([function(t,e,o){"use strict";t.exports.Glyph=o(1),t.exports.GlyphBuilder=o(2),t.exports.FXGlyph=o(3),t.exports.BoundingBox=o(5),t.exports.BoxTransformer=o(6)},function(t,e){"use strict";function o(t){return t.map(function(t){if("object"!=typeof t)throw"bad stroke spec: must be object";if("number"==typeof t[0]){for(var e=[],o=0;o<t.length;o+=2)e.push({x:t[o],y:t[o+1]});return e}if("object"==typeof t[0])return t;throw"bad stroke spec: first must be number or (x,y) pair"})}var s=function(t){this.id=t&&t.id||"",this.device=t&&t.device||"",this.strokes=t&&t.strokes&&o(t.strokes)||[],this.scale=t&&t.scale};t.exports=s},function(t,e,o){"use strict";var s=o(1),i=function(){s.call(this),this.strokeInProgress=!1};i.prototype=Object.create(s.prototype),i.prototype.constructor=i,i.prototype.setDevice=function(t){this.device=t},i.prototype.addPoint=function(t){var e=this;e.strokeInProgress||(e.strokes.push([]),e.strokeInProgress=!0);var o=e.strokes[e.strokes.length-1];if(o.length>0){var s=o[o.length-1];if(s.x===t.x&&s.y===t.y)return}o.push(t)},i.prototype.endStroke=function(){var t=this;if(t.strokeInProgress){var e=t.strokes[t.strokes.length-1];0===e.length&&t.strokes.pop(),t.strokeInProgress=!1}},i.prototype.getGlyph=function(){return new s({strokes:this.strokes,device:this.device})},t.exports=i},function(t,e,o){"use strict";var s=o(4),i=o(5),r=o(6),n=function(t){if(!t.scale)throw"glyph must have scale for successful feature extraction";this._glyph=t,this._scale=t.scale};n.prototype={get glyph(){return this._glyph},get scale(){return this._scale},get id(){return this._glyph.id},get device(){return this._glyph.device},get bbox(){return this._bbox||(this._bbox=this._getBBox(this._glyph)),this._bbox},get strokes(){return this._glyph.strokes},get unitScaledStrokes(){return this._unitScaledStrokes||(this._unitScaledStrokes=n.getScaledStrokes(this.strokes,this.bbox,new i("unit"))),this._unitScaledStrokes},get size(){return this._sizes||(this._size=this._getSize()),this._size},get sizes(){return this._sizes||(this._sizes=this._getSizes()),this._sizes},get subStrokes(){return this._subStrokes||(this._subStrokes=this._getSubStrokes()),this._subStrokes},get signature(){return this._signature||(this._signature=this._getSignature()),this._signature},get featureVector(){return this._featureVector||(this._featureVector=this._getFeatureVector()),this._featureVector}},n.prototype._getBBox=function(t){var e=t.strokes.map(function(t){return new i(t)});return new i(e)},n.getScaledStrokes=function(t,e,o){var i=new r(e,o),n=Math.min(o.right-o.left,o.bottom-o.top),h=t.map(function(t){var e=t.map(function(t){return{x:i.x(t.x),y:i.y(t.y)}});return new s(e,n)});return h},n.prototype._getSizes=function(){return this.unitScaledStrokes.map(function(t){return t.size})},n.prototype._getSize=function(){return this.sizes.reduce(function(t,e){return t+e},0)},n.prototype._getSubStrokes=function(){var t=[];return this.unitScaledStrokes.forEach(function(e){var o=e.subStrokes;o.forEach(function(e){t.push(e)})}),t},n.prototype._getSignature=function(){return this.subStrokes.map(function(t){return t.type}).join(":")},n.prototype._getFeatureVector=function(){var t=[],e=1/Math.sqrt(s.PC_DOT_COUNT),o=1/Math.sqrt(this.subStrokes.length);return this.subStrokes.forEach(function(s){if("mark"===s.type){var i=s.pcDots[0];t.push(i.x*o),t.push(i.y*o)}else s.pcDots.forEach(function(s){t.push(s.x*o*e),t.push(s.y*o*e)})}),t},n.prototype.distanceFrom=function(t){return n.euclideanDistance(this.featureVector,t.featureVector)},n.euclideanDistance=function(t,e){if(t.length!==e.length)throw"feature vectors must be same length";for(var o=0,s=0;s<t.length;++s){var i=t[s]-e[s];o+=i*i}return Math.sqrt(o)},t.exports=n},function(t,e){"use strict";function o(t,e,o){if(e.length!=t.length)throw"st.length must equal xt.length";if(0!==e[0])throw"st[0] must be equal to zero";for(var s=1;s<=e.length;s++)if(e[s]<e[s-1])throw"st must increase monotonically";if(o<=0||"number"!=typeof o)throw"n must be number > 0";for(var i=t.length,r=e[i-1],n=0,h=0,u=[],c=0;c<o;c++){for(var f=r*(c/(o-1));e[h]<f&&h<e.length-1;)h+=1;for(n=h;e[n]>f&&n>0;)n-=1;var p=e[n],a=e[h];if(p!==a){var l=a-p,g=t[h]-t[n],b=t[n];u.push(b+g*(f-p)/l)}else u.push(t[n])}return u}function s(t,e){for(var s=t.map(function(t){return t.x}),r=t.map(function(t){return t.y}),n=t.length,h=[],u=0;u<n;u++)h.push(e*u/(n-1));for(var c=o(s,h,i.PC_DOT_COUNT),f=o(r,h,i.PC_DOT_COUNT),p=[],a=0;a<i.PC_DOT_COUNT;a++)p.push({x:c[a],y:f[a]});return p}var i=function(t,e){this._points=t,this._scale=e};i.DS_UNIT_DEFAULT=.05,i.PC_DOT_COUNT=9,i.getEqualSamples=o,i.prototype={get points(){return this._points},get scale(){return this._scale},get size(){return"undefined"==typeof this._size&&(this._size=this._calculateSize()),this._size},get ds(){return"undefined"==typeof this._dS&&(this._ds=this._getDS()),this._ds},get sList(){return"undefined"==typeof this._sList&&(this._sList=this._getSList()),this._sList},get sStroke(){return"undefined"==typeof this._sStroke&&(this._sStroke=this._getSStroke()),this._sStroke},get subStrokes(){return this._subStrokes||(this._subStrokes=this._getSubStrokes()),this._subStrokes}},i.prototype._calculateSize=function(){return this.sList[this.points.length-1]},i.prototype._getDS=function(){var t=this.scale*i.DS_UNIT_DEFAULT,e=Math.floor(this.size/t),o=t;return e>0&&(o=this.size/e),o},i.prototype._getSList=function(){for(var t=[0],e=0,o=this.points[0].x,s=this.points[0].y,i=1;i<this.points.length;i++){var r=this.points[i].x,n=this.points[i].y,h=r-o,u=n-s,c=Math.sqrt(h*h+u*u);e+=c,t.push(e),o=r,s=n}return t},i.prototype._getSStroke=function(){for(var t=this.sList,e=this.points.map(function(t){return t.x}),o=this.points.map(function(t){return t.y}),s=1+Math.floor(this.size/this.ds+.1),r=i.getEqualSamples(e,t,s),n=i.getEqualSamples(o,t,s),h=[],u=0;u<s;u++)h.push({x:r[u],y:n[u]});return h},i.prototype._getSubStrokes=function(){function t(t,e,o){for(var s=[],r=e;r<=o;r++)s.push(t[r]);a.push(new i(s,this.scale)),l.push(this.ds*(o+1-e))}if(this.sStroke.length<=2)return[{type:"mark",stroke:new i([this.points[0]],this.scale),pcDots:[this.points[0]]}];var e,o=[];for(e=1;e<this.sStroke.length;e++){var r=this.sStroke[e].x-this.sStroke[e-1].x,n=this.sStroke[e].y-this.sStroke[e-1].y;o.push({dx:r,dy:n})}var h=[];for(e=1;e<o.length;e++){var u=o[e-1],c=o[e],f=u.dx*c.dx+u.dy*c.dy,p=f/(this.ds*this.ds);p<-.1&&h.push(e)}h.push(this.sStroke.length-1);for(var a=[],l=[],g=0,b=0;b<h.length;){var m=h[b];t.call(this,this.sStroke,g,m),g=m,b++}return a.map(function(t,e){var o=0===e,i=e===a.length-1,r=o&&i?"stroke":o&&!i?"start":!o&&i?"end":"middle",n=s(t.points,l[e]);return{type:r,stroke:t,pcDots:n}})},t.exports=i},function(t,e){"use strict";var o=function(t,e,o,s){function i(t,e,o,s){this.top=Math.min(e,s),this.left=Math.min(t,o),this.bottom=Math.max(e,s),this.right=Math.max(t,o)}function r(){this.top=0,this.left=0,this.bottom=1,this.right=1}function n(t){function e(t){if(t.top>t.bottom||t.left>t.right)throw"invalid box: top > bottom or left > right"}var o=t[0];"number"==typeof o.top?(e(o),this.top=o.top,this.left=o.left,this.right=o.right,this.bottom=o.bottom):(this.top=this.bottom=o.y,this.left=this.right=o.x);for(var s=1;s<t.length;++s){var i=t[s];"number"==typeof i.top?(e(i),this.left=Math.min(this.left,i.left),this.right=Math.max(this.right,i.right),this.top=Math.min(this.top,i.top),this.bottom=Math.max(this.bottom,i.bottom)):(this.left=Math.min(this.left,i.x),this.right=Math.max(this.right,i.x),this.top=Math.min(this.top,i.y),this.bottom=Math.max(this.bottom,i.y))}}if(this.top=void 0,this.left=void 0,this.bottom=void 0,this.right=void 0,"number"==typeof t&&"number"==typeof e&&"number"==typeof o&&"number"==typeof s)i.call(this,t,e,o,s);else if("object"==typeof t&&"number"==typeof t.top)n.call(this,arguments);else if("object"==typeof t&&"number"==typeof t.length&&t.length>0)n.call(this,t);else{if("unit"!==t)throw"unexpected BoundingBox parameters";r.call(this)}};t.exports=o},function(t,e){"use strict";var o=function(t,e,o){function s(t){return(t-u)*g+a}function i(t){return(t-c)*b+l}this.fromBox=t,this.toBox=e,this.x=s,this.y=i,this.options={center:!0,maintainAspectRatio:!0};var r=this;Object.keys(o||{}).forEach(function(t){r.options[t]=o[t]});var n=this.fromBox.right-this.fromBox.left;0===n&&(n=1);var h=this.fromBox.bottom-this.fromBox.top;0===h&&(h=1);var u=this.fromBox.left,c=this.fromBox.top,f=this.toBox.right-this.toBox.left,p=this.toBox.bottom-this.toBox.top,a=this.toBox.left,l=this.toBox.top;this.options.center&&(u=.5*(this.fromBox.left+this.fromBox.right),c=.5*(this.fromBox.top+this.fromBox.bottom),a=.5*(this.toBox.left+this.toBox.right),l=.5*(this.toBox.top+this.toBox.bottom));var g=f/n,b=p/h,m=Math.min(g,b);this.options.maintainAspectRatio&&(g=m,b=m)};t.exports=o}])});
//# sourceMappingURL=handlib.min.js.map